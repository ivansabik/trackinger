<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<title>trackinger</title>
			<script src="js/util.js"></script>
		<script src="js/geo.js"></script>
	</head>	
	<body>
    <div id="route-canvas"></div>
		<script>
      route = {'points': []};
      route.toHtml = function() {
        var html = '';
        for(var i=0; i<this.points.length; i++) {
          html += '<p>';
          html += 'Time: ' + this.points[i].time + '</br>';
          html += 'Latitude: ' + this.points[i].lat + '</br>';
          html += 'Longitude: ' + this.points[i].lon + '</br>';
          html += '</p>';
        }
        return html;
      };
      var int = self.setInterval(function(){getLocation()}, 5000);
      function getLocation() {
        navigator.geolocation.getCurrentPosition(showPosition);
      }
      function showPosition(position) {
        var requestTime = new Date().getTime();
        var routePoint = {
          'time': requestTime,
          'lat': position.coords.latitude,
          'lon': position.coords.longitude
        };
        route.points.push(routePoint);
        // Send route to server would be here
        console.log(routePoint);
        document.getElementById('route-canvas').innerHTML = route.toHtml();
      }
		</script>
	</body>
</html>
